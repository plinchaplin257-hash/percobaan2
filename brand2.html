<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GUCCI</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:#cfcfcf}

/* HEADER */
.header{display:flex;align-items:center;padding:10px;background:#000;color:#fff}
.back{cursor:pointer;font-size:20px}
.saldo{margin-left:auto;border:1px solid #555;padding:6px 12px}

/* MAIN CONTENT */
.main{padding:15px}
.top-info{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:20px}
.box{background:#000;color:#fff;padding:8px;text-align:center;border-radius:8px;transition:all .2s ease;}
.box:active{transform:scale(.96);box-shadow:0 4px 12px rgba(0,0,0,.7);}
.content{display:grid;grid-template-columns:1fr 1fr;gap:15px}
.product-list{display:flex;flex-direction:column;gap:10px}
.product{background:#000;color:#fff;padding:10px;cursor:pointer;border-radius:999px;transition:all .2s ease;position: relative;overflow: hidden;text-align:center;}
.product:hover{transform:scale(1.03)}
.product.active{background:#b84d00;box-shadow:0 0 0 2px #ffb26a,0 6px 15px rgba(255,122,0,.7);}
.logo-box{background:#000;height:200px;display:flex;justify-content:center;align-items:center;border-radius:12px;transition:all .25s ease;}
.logo-box img{max-width:90%;max-height:90%;pointer-events:none}
.image-grid{margin:15px 0;display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.image-box{background:#000;height:70px;border-radius:8px;overflow:hidden;transition:all .2s ease;}
.image-box img{width:100%;height:100%;object-fit:cover;pointer-events:none}
.bottom-input{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:20px}
input{padding:8px}
.total{background:#fff;padding:8px}
.saldo-overlay{text-align:center;margin:18px 0 12px;background:rgba(0,0,0,.15);padding:8px;border-radius:8px;}
.send{width:100%;padding:12px;margin-top:10px;background:#ff2f00;color:#fff;border:none;border-radius:10px;font-weight:bold;letter-spacing:1px;transition:all .2s ease;}
.success{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#2ecc71;color:#fff;padding:15px 25px;border-radius:8px;font-weight:bold;z-index:999}
.warning{display:none;background:red;color:#fff;text-align:center;padding:10px;margin:10px 0;font-weight:bold;animation:blink 1s infinite}
@keyframes blink{50%{opacity:.5}}

/* NAV */
.nav{margin-top:10px;display:flex;background:#bfbfbf;}
.nav a{flex:1;text-align:center;padding:12px;text-decoration:none;font-weight:bold;color:#000;}
.nav a.active{color:#ff7a00;}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
    <div class="back" onclick="history.back()">‹</div>
    <div class="saldo" id="orderNumber"></div>
</div>

<!-- MAIN -->
<div class="main">
    <div class="top-info">
        <div class="box" id="sessionTime">05:00</div>
        <div class="box">GUCCI</div>
    </div>

    <div class="content">
        <div class="product-list">
            <div class="product" data-jenis="PRODUK UNGGULAN">PRODUK UNGGULAN</div>
            <div class="product" data-jenis="PRODUK GANDA">PRODUK GANDA</div>
            <div class="product" data-jenis="GANDA BAGIAN">GANDA BAGIAN</div>
            <div class="product" data-jenis="TUNGGAL BAGIAN">TUNGGAL BAGIAN</div>
        </div>
        <div class="logo-box"><img src="gucci.png"></div>
    </div>

    <div class="image-grid">
        <div class="image-box"><img src="gucci1.jpg"></div>
        <div class="image-box"><img src="gucci2.jpg"></div>
        <div class="image-box"><img src="gucci3.jpg"></div>
        <div class="image-box"><img src="gucci4.jpg"></div>
        <div class="image-box"><img src="gucci5.jpg"></div>
        <div class="image-box"><img src="gucci6.jpg"></div>
        <div class="image-box"><img src="gucci7.jpg"></div>
        <div class="image-box"><img src="gucci8.jpg"></div>
        <div class="image-box"><img src="gucci9.jpg"></div>
        <div class="image-box"><img src="gucci10.jpg"></div>
        <div class="image-box"><img src="gucci11.jpg"></div>
        <div class="image-box"><img src="gucci12.jpg"></div>
        <div class="image-box"><img src="gucci13.jpg"></div>
        <div class="image-box"><img src="gucci14.jpg"></div>
        <div class="image-box"><img src="gucci15.jpg"></div>
    </div>

    <div class="bottom-input">
        <input type="number" id="nominal" placeholder="NOMINAL">
        <div class="total">TOTAL: Rp <span id="total">0</span></div>
    </div>
    <div class="saldo-overlay">Saldo Akun: Rp <span id="saldoAkun"></span></div>
    <button class="send" id="sendBtn">KIRIM</button>
    <div class="warning" id="warning">⚠️ Saldo Akun Tidak Mencukupi</div>
    <div class="success" id="successMsg">Pesanan berhasil ✔️</div>
</div>

<!-- NAV -->
<div class="nav">
    <a href="home.html">HOME</a>
    <a href="order.html">ORDER</a>
    <a href="mine.html">MINE</a>
</div>

<script>
// ======== CEK LOGIN =========
if(localStorage.getItem('isLoggedIn') !== 'true'){
    location.href = 'login.html';
}

// ======== SALDO =========
let saldo = Number(localStorage.getItem('saldo') || 1000000);
const saldoAkun = document.getElementById('saldoAkun');
function updateSaldo(){
    saldo = Number(localStorage.getItem('saldo') || 1000000);
    saldoAkun.innerText = saldo.toLocaleString('id-ID');
}
updateSaldo();

// ======== ORDER =========
let orders = JSON.parse(localStorage.getItem('orders')) || [];

const products = document.querySelectorAll('.product');
const nominalInput = document.getElementById('nominal');
const totalText = document.getElementById('total');
const sendBtn = document.getElementById('sendBtn');
const warning = document.getElementById('warning');
const successMsg = document.getElementById('successMsg');
const sessionTime = document.getElementById('sessionTime');
const orderNumber = document.getElementById('orderNumber');

const SESSION = 300;
let endTime = Number(localStorage.getItem('sessionEnd')) || (Date.now() + SESSION*1000);

// ======== NOMOR ORDER =========
function nextOrder(){
    const d = new Date();
    const keyDate = `${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`;
    let n = Number(localStorage.getItem(keyDate)||0) + 1;
    localStorage.setItem(keyDate, n);
    orderNumber.innerText = `${keyDate}${String(n).padStart(4,'0')}`;
}
nextOrder();

// ======== HITUNG TOTAL =========
function hitungTotal(){
    const n = Number(nominalInput.value || 0);
    let total = 0;
    products.forEach(p=>{if(p.classList.contains('active')) total+=n;});
    totalText.innerText = total.toLocaleString('id-ID');
    return total;
}

// ======== SELECT PRODUCT =========
products.forEach(p=>{p.onclick=()=>{p.classList.toggle('active'); hitungTotal();}});
nominalInput.oninput = hitungTotal;

// ======== KIRIM PESANAN =========
sendBtn.onclick = ()=>{
    const total = hitungTotal();
    if(total > saldo){ warning.style.display='block'; setTimeout(()=>warning.style.display='none',2000); return; }

    // Simpan pesanan
    const order = {
        brand: 'GUCCI',
        id: orderNumber.innerText,
        profit: total,
        time: new Date().toLocaleString(),
        status: 'Proses'
    };
    orders.push(order);
    localStorage.setItem('orders', JSON.stringify(orders));

    // Update saldo
    saldo -= total;
    localStorage.setItem('saldo', saldo);
    updateSaldo();

    // Reset form
    nominalInput.value = '';
    totalText.innerText = '0';
    products.forEach(p=>p.classList.remove('active'));
    nextOrder();

    successMsg.style.display = 'block';
    setTimeout(()=>successMsg.style.display='none',2000);
}

// ======== TIMER SESI =========
setInterval(()=>{
    let s = Math.floor((endTime-Date.now())/1000);
    sessionTime.innerText = `${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;

    if(s <= 5 && s > 0){ alert("⏰ Waktu sesi akan berakhir, silakan menunggu sesi berikutnya"); }

    if(s <= 0){
        const total = hitungTotal();
        const active = [...products].filter(p=>p.classList.contains('active'));
        const types = active.map(p=>p.dataset.jenis);
        if(active.length > 0){
            const onlyUGG_GANDA = types.every(t=>t==='PRODUK UNGGULAN'||t==='PRODUK GANDA');
            if(onlyUGG_GANDA){ saldo += Number(nominalInput.value || 0)*2; }
            else{ saldo -= total; if(saldo<0) saldo=0; }
        }
        localStorage.setItem('saldo', saldo);
        updateSaldo();
        products.forEach(p=>p.classList.remove('active'));
        nominalInput.value=''; totalText.innerText='0';
        endTime = Date.now() + SESSION*1000;
        localStorage.setItem('sessionEnd', endTime);
        nextOrder();
    } else { localStorage.setItem('sessionEnd', endTime); }
},1000);
</script>

</body>
</html>
